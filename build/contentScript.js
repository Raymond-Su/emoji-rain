(()=>{const t={position:"fixed",background:"transparent",overflow:"hidden",visibility:"hidden",left:0,right:0,top:0,bottom:0,margin:0,padding:0};class i{constructor(t,i,e){this.text=t,this.x=Math.random()*e,this.y=Math.random()*i,this.vx=0,this.vy=9.81,this.font="14px serif"}drawDrop(t){t.font=this.font,t.fillText(this.text,this.x,this.y)}move(t,i){this.x+=this.vx,this.y+=this.vy,(this.x>i||this.y>t)&&(this.x=Math.random()*i,this.y=-20)}}class e{constructor(){this.canvas=this.getOrCreateCanvas(),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.ctx=this.canvas.getContext("2d"),this.rainLoopId=null}getOrCreateCanvas(){if(document.getElementById("rain-engine"))return document.getElementById("rain-engine");const i=document.createElement("canvas");return i.id="rain-engine",i.height=window.innerHeight,i.width=window.innerWidth,i.style.cssText=Object.entries(t).reduce(((t,i)=>`${t} ${i[0]}: ${i[1]};`),""),document.body.appendChild(i),i}getEmojiFromCodePoint(t){let i="string"==typeof t?parseInt(t,16):t;return i<65536?String.fromCharCode(i):(i-=65536,String.fromCharCode(55296+(i>>10),56320+(1023&i)))}generateEmojiDrops(t){const e=[],n=this.getEmojiFromCodePoint(t);for(let t=0;t<100;t++)e.push(new i(n,this.canvas.height,this.canvas.width));return e}drawRain(t){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(let i=0;i<100;i++)t[i].drawDrop(this.ctx),t[i].move(this.canvas.height,this.canvas.width)}resize(){this.canvas.height=window.innerHeight,this.canvas.width=window.innerWidth}start(t){this.canvas.style.visibility="visible",this.rainLoopId=setInterval(this.drawRain.bind(this),50,t)}stop(){clearInterval(this.rainLoopId),this.rainLoopId=null,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.style.visibility="hidden"}}!function(){const t=new e;window.addEventListener("resize",(()=>t.resize())),chrome.runtime.onMessage.addListener(((i,e,n)=>{if("TOGGLE_RAIN"===i.type){const e=t.generateEmojiDrops(i.payload);t.start(e)}else t.stop()}))}()})();